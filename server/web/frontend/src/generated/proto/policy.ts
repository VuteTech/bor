// Code generated by protoc-gen-ts_proto. DO NOT EDIT.
// versions:
//   protoc-gen-ts_proto  v2.11.2
//   protoc               v6.33.0
// source: policy.proto

/* eslint-disable */
import type { ChromePolicy } from "./chrome";
import type { FirefoxPolicy } from "./firefox";
import type { KConfigPolicy } from "./kconfig";

export const protobufPackage = "bor.policy.v1";

/** Policy represents a desktop policy configuration */
export interface Policy {
  /** Unique policy identifier */
  id: string;
  /** Policy name */
  name: string;
  /** Policy description */
  description: string;
  /** Policy type (e.g., "firewall", "software", "security") */
  type: string;
  /** Policy configuration in JSON format */
  content: string;
  /** Policy version */
  version: number;
  /** Creation timestamp */
  created_at:
    | Date
    | undefined;
  /** Last update timestamp */
  updated_at:
    | Date
    | undefined;
  /** Whether the policy is enabled */
  enabled: boolean;
  firefox_policy?: FirefoxPolicy | undefined;
  kconfig_policy?: KConfigPolicy | undefined;
  chrome_policy?: ChromePolicy | undefined;
}

/** GetPolicyRequest requests a specific policy */
export interface GetPolicyRequest {
  policy_id: string;
}

/** GetPolicyResponse contains the requested policy */
export interface GetPolicyResponse {
  policy: Policy | undefined;
}

/** ListPoliciesRequest requests policies for a client */
export interface ListPoliciesRequest {
  /** Client identifier (hostname, MAC address, etc.) */
  client_id: string;
  /** Optional filter by policy type */
  type_filter: string;
  /** Pagination: page size */
  page_size: number;
  /** Pagination: page token */
  page_token: string;
}

/** ListPoliciesResponse contains a list of policies */
export interface ListPoliciesResponse {
  policies: Policy[];
  /** Next page token (empty if no more pages) */
  next_page_token: string;
  /** Total count of policies */
  total_count: number;
}

/** SubscribePolicyUpdatesRequest subscribes to policy updates */
export interface SubscribePolicyUpdatesRequest {
  /** Client identifier */
  client_id: string;
  /**
   * Last revision the client has seen.
   *   0          → client has no state, server sends a full snapshot.
   *   > 0        → server attempts a delta from that revision;
   *                if too old (compacted) it falls back to full snapshot.
   */
  last_known_revision: number;
}

/** PolicyUpdate represents a policy change notification */
export interface PolicyUpdate {
  type: PolicyUpdate_UpdateType;
  policy:
    | Policy
    | undefined;
  /**
   * Server-side revision after this event. Clients should persist
   * this and send it back in last_known_revision on reconnect.
   */
  revision: number;
  /**
   * When true, indicates that this is the last message of a full
   * snapshot batch. The client should apply all received SNAPSHOT
   * messages atomically.
   */
  snapshot_complete: boolean;
}

/** Update type */
export enum PolicyUpdate_UpdateType {
  UNKNOWN = 0,
  CREATED = 1,
  UPDATED = 2,
  DELETED = 3,
  /** SNAPSHOT - SNAPSHOT indicates a full policy snapshot entry (one per policy). */
  SNAPSHOT = 4,
  /**
   * METADATA_REQUEST - METADATA_REQUEST is a server-to-agent command asking the agent
   * to collect and report fresh system metadata via the Heartbeat RPC.
   */
  METADATA_REQUEST = 5,
  UNRECOGNIZED = -1,
}

/** ReportComplianceRequest reports policy compliance status */
export interface ReportComplianceRequest {
  /** Client identifier */
  client_id: string;
  /** Policy ID */
  policy_id: string;
  /** Compliance status */
  compliant: boolean;
  /** Status message or error details */
  message: string;
  /** Timestamp of the report */
  reported_at: Date | undefined;
}

/** ReportComplianceResponse acknowledges compliance report */
export interface ReportComplianceResponse {
  success: boolean;
}

export interface GetAgentConfigRequest {
}

export interface GetAgentConfigResponse {
  config: AgentConfig | undefined;
}

export interface AgentConfig {
  notify_users: boolean;
  notify_cooldown_seconds: number;
  notify_message: string;
  notify_message_firefox: string;
  notify_message_chrome: string;
}

/** NodeInfo contains metadata reported by an agent node. */
export interface NodeInfo {
  fqdn: string;
  ip_address: string;
  /** Distribution name, e.g. "Fedora", "Fedora Atomic", "Ubuntu", "openSUSE Leap", "SLES" */
  os_name: string;
  /** Version string, e.g. "40", "22.04", "15.6" */
  os_version: string;
  /** Desktop environments installed, e.g. ["KDE Plasma 6.1.4", "GNOME 46.1"] */
  desktop_envs: string[];
  agent_version: string;
  machine_id: string;
}

export interface HeartbeatRequest {
  client_id: string;
  info: NodeInfo | undefined;
}

export interface HeartbeatResponse {
  accepted: boolean;
}
